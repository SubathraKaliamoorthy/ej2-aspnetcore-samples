@page
@model EJ2CoreSampleBrowser.Pages.Excel.EncryptAndDecrypt
@section ActionDescription {
    This sample demonstrates how to encrypt and decrypt workbooks using XlsIO.
}

@section Meta {
    <meta name="description" content="This example demonstrates the Encrypt and Decrypt in ASP.NET Core Excel (XlsIO) library. Explore here for more details." />
}

@section Description {
        This sample focuses on the encryption and decryption of an Excel 2007, Excel 2010, Excel 2013 and Excel 2016 workbook using Essential XlsIO.
    <br />
    <br />Encryption is a method of protecting workbook data.It is based on a password that converts the data into a form that cannot be understood; it also restricts anonymous users from accessing a document. Decryption is the process of converting encrypted data back into its original form so that data can be read from the workbook.
    <br />
    <br />A password for encrypting a workbook can be set in Microsoft Excel 2007, Excel 2010 and Excel 2013 through the Office Menu->Prepare->Encrypt Document command.
    <br />
    <br />
    <b>Note:</b> Password protection of a workbook file is different from the workbook structure and window protection you can set in the <b>Review->Protect Workbook</b>
    <br />
    <br />
    <br />
    <b>Features:</b>
    <br />
    <br />
    <ul>
        <li>Encrypting with a password</li>
        <li>Decrypting with a password</li>
    </ul>
    <br />
}
@section ControlsSection {
    <div class="control-section">
        @{
            Html.BeginForm("encryptanddecrypt", "excel", FormMethod.Post, new { enctype = "multipart/form-data" });
            {
                <p style="font-weight:normal">
                    Click the "Encrypt Document" button to view the encrypted Excel document and click the "Decrypt Document" button to view the decrypted Excel document. Please note that the Microsoft Excel viewer or Microsoft Excel is required to view the Excel document.
                </p>
                <br />
                <div style="display:flex">
                    <label style="font-weight:normal;margin-right: 1rem;">Select document to Encrypt or Decrypt</label>
                    <input type="button" value="Browse" onclick="openPage()">
                    <input type="text" id="fileNameBox" value="EncryptedDocument.xlsx" readonly="readonly" style="border:none;margin-left:1rem;" />
                    <input type="file" name="file" id="fileUpload" accept=".xlsx,.xls,.xlsm,.xltm,.xltx,.csv,.tsv,.xml" style="display:block;visibility:hidden;width:0;height:0;">
                </div>
                <br />
                <div style="display:flex">
                    <label style="font-weight:normal;margin-right: 19.1rem;">Password</label>
                    <input placeholder="Enter password" type="text" id="password" value="PASSWORD" name="password" />
                </div>
                <br />
                <div>
                    Save As
                    <input type="radio" id="XLS" name="saveOption" value="Xls" style="margin-left: 19.8rem" />
                    <label for="XLS" style="font-weight:normal">XLS</label>
                    &nbsp;
                    <input type="radio" id="XLSX" name="saveOption" value="xlsx" checked="checked" />
                    <label for="XLSX" style="font-weight:normal">XLSX</label>
                </div>
                <br />
                <div class="celldiv">
                    <input id="encryptbtn" class="e-btn" type="submit" name="button" value="Encrypt Document" style="width:160px; text-transform:capitalize" />
                    <input id="decryptbtn" class="e-btn" type="submit" name="button" value="Decrypt Document" style="width:160px; text-transform:capitalize" />
                </div>
                <br />
                <div>
                    <p>
                        <b>Note:</b>  Before clicking the "Encrypt Document" button, select the Excel document to be encrypted and enter a password. Before clicking the "Decrypt Document" button, select an encrypted Excel document and enter the document password.
                    </p>
                </div>
                Html.EndForm();
            }
        }
    </div>
    <script>
        function openPage() {
            document.getElementById('fileUpload').click();
            document.getElementById('fileUpload').addEventListener('change', readFile, false);
        }
        function readFile(evt) {
            var upoadedFiles = evt.target.files;

            filename = upoadedFiles[0].name;
            document.getElementById('fileNameBox').value = filename;
        }
    </script>
}
@section Title {
    <title>ASP.NET Core Excel (XlsIO) library - Encrypt and Decrypt Example - Syncfusion Demos </title>
}
@section Header {
    <h1 class='sb-sample-text'>Example of Encrypt and Decrypt in ASP.NET Core Excel (XlsIO) Library</h1>
}
